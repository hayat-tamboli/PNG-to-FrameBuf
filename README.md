Seriously inspired from https://forum.micropython.org/viewtopic.php?t=4806&start=20#p42487
